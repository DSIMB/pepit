<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>README.html</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>

</head>

<body>

<h1 id="pepit">PEPIT</h1>
<p>(C) Frédéric Guyon, Gautier Moroy</p>
<p><strong>Non-sequential alignment of binding sites for fast peptide screening</strong></p>
<h2 id="abstract">Abstract</h2>
<p>The PepIT program proposes peptides that may interact with a given protein. PepIT is based on a non-sequential alignment algorithm to identify peptide binding sites that share geometrical and physicochemical properties with regions on the target protein. PepIT compares the entire surface of the target protein with the peptide binding sites in the Propedia dataset, which contains more than 19,000 high-resolution protein-peptide structures. Once a peptide binding site similar to a portion of the protein surface is found, the peptide inserted into the binding site is repositioned on the corresponding portion of the protein surface.</p>
<h2 id="dependencies">Dependencies</h2>
<p>The R program is required as Pepit is a R package. A few R scripts are included that make use of the pepit R package. No R programming is required.</p>
<h2 id="installation">Installation</h2>
<p>The pepit package is installed on github repository https://github.com/DSIMB/pepit.</p>
<p>Invoke R and type:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">&quot;DSIMB/pepit&quot;</span>)</span></code></pre></div>
<h2 id="usage">Usage</h2>
<p>Two scripts make use of the package pepit.</p>
<p>BuiltBSBank.R builds a bank of protein-peptide complexes with the format expected by pepit</p>
<p>pepit.R performs a search of a binding site of the bank similar to the given protein target.</p>
<h3 id="bank-of-complexes-preparation">Bank of complexes preparation</h3>
<p>As input, the script takes a bank description file, that is a 3 columns file with a header, that can be read by R as a data frame.</p>
<p>The second input is a directory name where are written the ouput complexe pdb files.</p>
<p>Example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> Bank</span></code></pre></div>
<p>For example, with the following file nanobank.dat</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">PDB</span> Receptor.Chain Peptide.Chain</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">148l</span> E S</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ex">1a07</span> A C</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="ex">1a07</span> B D</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">1a08</span> A C</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> ./BuiltBSBank.R nanobank.dat Bank</span></code></pre></div>
<p>the script produces 4 pdb files <code>148lE:S.pdb</code> <code>1a07A:C.pdb</code> <code>1a07B:D.pdb</code> <code>1a08A:C.pdb</code></p>
<h3 id="peptide-search">Peptide search</h3>
<p>use the script <code>pepit.R</code></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> ./pepit.R target target_chain BSBank prefix</span></code></pre></div>
<ul>
<li>target is a pdb file or a pdb id. In this case, <code>pepit.R</code> download the pdb file from the Protein Data Bank RCSB PDB.</li>
<li>target_chain gives the receptor chain of the pdb target file. It can be a single character or a list of chains as H,L or A,B,C or “*” meaning all the protein chains (the double quote are mandatory)</li>
<li>BSBank is binding site bank created by <code>BuiltBSBank.R</code></li>
<li>prefix is a string used as a prefix for the names of all the output files.</li>
</ul>
<p>By default, <code>pepit.R</code> produces 1 output file : <prefix>.score</p>
<p>It is possible to change the default values of the program parameters at the beginning of the script file.</p>
<p>All the parameter default values are indicated in <code>pepit/inst/default_parameters.R</code>. This R file cannot be used to change the values</p>
<p>of the parameters, it is just here for information. The parameters must be changed in the R scripts `pepit.R</p>
<p>For example, if the parameter POSE is set to TRUE, an alignment file that gives the mapping between the protein target and the selected binding sites is output.</p>
<p>This file name is <prefix>.al. PDB files with the selected peptides posed onto the target are also produced.</p>
<h3 id="example">Example</h3>
<p>We search for a peptide able to interact with a BCL-XL target with pdb id 2bzw.</p>
<p>The pdb file contains a structure of BCL-XL (chain A) in complex with the peptide BAD (chain B).</p>
<p>For the test, we consider the chain A only and we compare it to 4 binding sites of 2bzw, 3r85, 4qve, 1cm1.</p>
<p>2bzw, 3r85, 4qve are BCL-XL structures complexed to different peptides and 1cm1 is calmodulin that is not homologous to BCL-XL.</p>
<p>The input text file <code>nanobank.dat</code> used to construct the binding site bank is:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">PDB</span> Receptor.Chain Peptide.Chain </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">2bzw</span> A B</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ex">3r85</span> D H</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="ex">4qve</span> A B</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="ex">1cm1</span> A B</span></code></pre></div>
<p>The R script <code>BuiltBSBank.R</code> in <code>pepit/inst</code> builds the bank and add binding site pdb files to a directory that already exists.</p>
<p>First create the directory</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> NanoBank</span></code></pre></div>
<p>and create the BS files</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> path_to_pepit/inst/BuiltBSBank.R nanobank.dat NanoBank</span></code></pre></div>
<p>BS files are row-column file (data frames) containing information on atoms of the receptor close to its peptide. The bank contains also associated peptide pdb files interacting with the binding sites.</p>
<p>Parameters can be changed in the script <code>BuiltBSBank.R</code> as followed</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">set.pepit</span><span class="er">(</span><span class="st">&quot;CONTACT&quot;</span><span class="ex">,</span> 8.0<span class="kw">)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">set.pepit</span><span class="er">(</span><span class="st">&quot;ADD&quot;</span><span class="ex">,</span> <span class="st">&quot;calpha&quot;</span><span class="kw">)</span></span></code></pre></div>
<p>These parameter values mean that atoms of receptor at less a 8.0 A of the peptide are selected.</p>
<p>All alpha carbons of the residues for which an atom is selected are added to the binding site</p>
<p>The search is performed by the R script <code>pepit.R</code> located in <code>pepit/inst</code></p>
<pre class="bashbcl-xl"><code>Rscript path_to_pepit/inst/pepit.R 2bzw A NanoBank 2bzw</code></pre>
<p>the first argument is a pdb id, a pdb file or a cif file. If it is an id, the pdb is fetched from the RCSB PDB.</p>
<p>the second argument is the chain or chains on which to match a binding site.</p>
<p>the third argument is directory name storing all the binding site files produced by <code>BuiltBSBank.R</code>.</p>
<p>the fourth argument is a string prefixing the output file names.</p>
<p>with the default parameters there is only one output file: the score file <code>2bzw.score</code></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">index</span> bs target precision bslen alen rmsd coverage meandist score clashes</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span> NanoBank/2bzwA:B.dat 2bzw 1 188 188 0 1 0 35344 NA</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="ex">2</span> NanoBank/4qveA:B.dat 2bzw 1 166 127 1.123 0.7650602 0.4789747 8403.616 NA</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="ex">3</span> NanoBank/3r85D:H.dat 2bzw 1 141 114 0.925 0.8085106 0.4256236 7464.595 NA</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="ex">4</span> NanoBank/1cm1A:B.dat 2bzw 1 184 31 2.868 0.1684783 0.5969728 387.3091 NA</span></code></pre></div>
<p><code>2bzw.al</code> contains the matching between atoms</p>
<p><code>2bzw.resi</code> contains the contacting target residue number for each selected peptide found in the BS bank.</p>
<p>if the parameter <code>POSE</code> is set to TRUE output files <code>2bzw_peptide-&lt;k&gt;.pdb</code> are produced</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.pepit</span>(<span class="st">&quot;POSE&quot;</span>, <span class="cn">TRUE</span>)</span></code></pre></div>
<p><code>2bzw-peptide-&lt;k&gt;.pdb</code> contains the peptide alone posed onto the protein target</p>
<p>Results can be visualised with</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pymol</span> 2bzw_peptide-<span class="pp">*</span> 2bzw.cif</span></code></pre></div>
<figure>
<img src="Pymol.png" alt="Pymol Results" /><figcaption aria-hidden="true">Pymol Results</figcaption>
</figure>
<p>To avoid poses inside the target, the parameter <code>MAXCLASHES</code> can be set to a reasonable value</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.pepit</span>(<span class="st">&quot;MAXCLASHES&quot;</span>, <span class="dv">10</span>)</span></code></pre></div>

</body>
</html>
